{% extends "template/admin.template.html" %}

{% block title %}Kelola Pengguna{% endblock %}

{% block content %}
<h2>Kelola Pengguna</h2>
<a class="waves-effect waves-light btn rata-kanan modal-trigger" href="#modal-tambah-pengguna">Tambah</a>

<!-- Modal Structure -->
<form method="POST" action="{{ urlFor('penggunacreate') }}" id="modal-tambah-pengguna" class="validated modal">
  <div class="modal-content">
    <h4>Tambah Pengguna</h4>
    <div class="row">
      <div class="col m12">
        <label for="npm-create">Nomor</label>
        <input id="npm-create" name="nomor" type="text" class="validate" required/>
      </div>
    </div>
    <div class="row">
      <div class="col m12">
        <label for="role-create">Nama</label>
        <input id="role-create" name="nama" type="text" class="validate" required/>
      </div>
    </div>
    <div class="row">
      <div class="col m12">
          <label for="jeniskelamin-update">Role</label>
          <select name="role" class="browser-default" required>
            <option disabled selected>Pilih Role</option>
            <option value="dosen">Dosen</option>
            <option value="mahasiswa">Mahasiswa</option>
            <option value="administrator">Administrator</option>
          </select>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="submit" class=" modal-action waves-effect waves-green btn">Simpan</button>
  </div>
</form>

<div class="rd-card white">
<table class="responsive-table white centered">
   <thead>
          <tr>
              <th data-field="id">Nomor</th>
              <th data-field="name">Nama</th>
              <th data-field="price">Role</th>
              <th data-field="price">Banned Hingga</th>
              <th data-field="price">Action</th>
          </tr>
        </thead>

        <tbody>
        {% for pengguna in daftarPengguna %}
          <tr>
            <td>{{ pengguna.nomor }}</td>
            <td>{{ pengguna.nama }}</td>
            <td>{{ pengguna.role }}</td>
            <td>{{ pengguna.banned_hingga}}</td>
            <td>
              <a href="#modal-ubah-pengguna-{{pengguna.id}}" class="modal-trigger rd-admin-action-btn"><i class="small mdi-editor-mode-edit"></i></a>&nbsp;
              <a href="#modal-hapus-pengguna-{{pengguna.id}}" class="modal-trigger rd-admin-action-btn"><i class="small mdi-action-delete"></i></a></td>
          </tr>
         {% endfor %}
        </tbody>
</table>
</div>

{% for pengguna in daftarPengguna %}
<!-- Modal Structure -->
<form method="POST" action="{{ urlFor('penggunaupdate', {'npm' : pengguna.id }) }}" id="modal-ubah-pengguna-{{pengguna.id}}" class="modal validated">
  <div class="modal-content">
    <h4>Ubah Pengguna {{pengguna.nama}}</h4>
    <div class="row">
      <div class="col m12">
        <label for="npm-update-{{pengguna.nomor}}">NPM</label>
        <input id="npm-update-{{pengguna.nomor}}" name="nomor" type="text" value="{{pengguna.nomor}}" required/>
      </div>
    </div>
    <div class="row">
      <div class="col m12">
        <label for="role-update-{{pengguna.npm}}">Nama</label>
        <input id="role-update-{{pengguna.npm}}" name="nama" type="text" value="{{pengguna.nama}}" required/>
      </div>
    </div>

    <div class="row">
      <div class="col m12">
        <label>Role</label>
        <select name="role" class="browser-default" required>
          <option {% if pengguna.role == 'dosen' %}selected="true"{%endif%} value="dosen">Dosen</option>
          <option {% if pengguna.role == 'mahasiswa' %}selected="true"{%endif%} value="mahasiswa">Mahasiswa</option>
          <option {% if pengguna.role == 'administrator' %}selected="true"{%endif%} value="administrator">Administrator</option>
        </select>
      </div>
    </div>
    <div class="row">
      <div class="col m12">
        <label for="status-update-{{pengguna.nomor}}">Banned Hingga</label>
        <input id="status-update-{{pengguna.nomor}}" name="bannedhingga" type="date" value="{{pengguna.banned_hingga}}" class="datepicker" required/>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="submit" class=" modal-action waves-effect waves-green btn">Simpan</button>
  </div>
</form>
<!-- Modal Structure -->
<div id="modal-hapus-pengguna-{{pengguna.id}}" class="modal">
  <div class="modal-content">
    <p>Apakah anda yakin ingin hapus pengguna <strong>{{ pengguna.nama }}</strong>?</p>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-action modal-close waves-effect waves-green btn">Batal</a>
    <a href="{{ urlFor('penggunadelete', {'npm' : pengguna.id }) }}" class="modal-action waves-effect waves-green btn geser-kanan-dikit">Hapus</a>
  </div>
</div>
{% endfor %}

{% endblock %}

{% block js %}
<script type="text/javascript">
// FORM VALIDATION 
  $('form.validated').each( function() {
    $(this).validate();
  });
</script>
{% endblock %}