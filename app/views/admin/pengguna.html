{% extends "admin.template.html" %}

{% block title %}Kelola Pengguna{% endblock %}

{% block content %}
{% if flash.notif is defined %}
<div class="row">
  <div class="col s12">
    <div class="card-panel green lighten-1">
      <span class="white-text">{{ flash.notif }}</span>
    </div>
  </div>
</div>
{% endif %}
<h2>Kelola Pengguna</h2>
<a class="waves-effect waves-light btn rata-kanan modal-trigger" href="#modal-tambah-pengguna">Tambah</a>

<!-- Modal Structure -->
<form method="POST" action="{{ urlFor('penggunacreate') }}" id="modal-tambah-pengguna" class="modal">
	<div class="modal-content">
		<h4>Tambah Pengguna</h4>
		<div class="row">
			<div class="col m12">
        <label for="npm-create">Nomor</label>
				<input id="npm-create" name="npm" type="text" class="validate" required/>
			</div>
		</div>
		<div class="row">
			<div class="col m12">
        <label for="role-create">Nama</label>
				<input id="role-create" name="nama" type="text" class="validate" required/>
			</div>
		</div>
		<div class="row">
			<div class="col m12">
          <label for="jeniskelamin-update">Role</label>
          <select name="role" required>
            <option value="" disabled selected>Pilih Role</option>
            <option value="dosen">Dosen</option>
            <option value="mahasiswa">Mahasiswa</option>
            <option value="administrator">Administrator</option>
          </select>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<button type="submit" class=" modal-action waves-effect waves-green btn">Simpan</button>
	</div>
</form>

<table class="responsive-table hoverable white centered">
   <thead>
          <tr>
              <th data-field="id">Nomor</th>
              <th data-field="name">Nama</th>
              <th data-field="price">Role</th>
              <th data-field="price">Banned Hingga</th>
              <th data-field="price">Action</th>
          </tr>
        </thead>

        <tbody>
        {% for pengguna in daftarPengguna %}
          <tr>
            <td>{{ pengguna.npm }}</td>
            <td>{{ pengguna.nama }}</td>
            <td>{{ pengguna.role }}</td>
            <td>{{ pengguna.banned_hingga}}</td>
            <td><a href="#modal-ubah-pengguna-{{pengguna.npm}}" class="modal-trigger"><i class="small mdi-editor-mode-edit"></i></a>&nbsp;<a href="#modal-hapus-pengguna-{{pengguna.npm}}" class="modal-trigger"><i class="small mdi-action-delete"></i></a></td>
          </tr>
         {% endfor %}
        </tbody>
</table>
	{% for pengguna in daftarPengguna %}
  <!-- Modal Structure -->
  <form method="POST" action="{{ urlFor('penggunaupdate', {'npm' : pengguna.npm }) }}" id="modal-ubah-pengguna-{{pengguna.npm}}" class="modal">
  	<div class="modal-content">
  		<h4>Ubah Pengguna {{pengguna.npm}}</h4>
  		<div class="row">
  			<div class="col m12">
  				<input id="npm-update-{{pengguna.npm}}" name="npm" type="text" value="{{pengguna.npm}}" required/>
  				<label for="npm-update-{{pengguna.npm}}">NPM</label>
  			</div>
  		</div>
  		<div class="row">
  			<div class="col m12">
  				<input id="role-update-{{pengguna.npm}}" name="nama" type="text" value="{{pengguna.nama}}" required/>
  				<label for="role-update-{{pengguna.npm}}">Nama</label>
  			</div>
  		</div>
  		<div class="row">
  			<div class="col m12">
          <label>Role</label>
          <select name="role" required>
            <option {% if pengguna.role == 'dosen' %}selected="true"{%endif%} value="dosen">Dosen</option>
            <option {% if pengguna.role == 'mahasiswa' %}selected="true"{%endif%} value="mahasiswa">Mahasiswa</option>
            <option {% if pengguna.role == 'administrator' %}selected="true"{%endif%} value="administrator">Administrator</option>
          </select>
  			</div>
  		</div>
  		<div class="row">
  			<div class="col m12">
  				<label for="status-update-{{pengguna.npm}}">Banned Hingga</label>
  				<input id="status-update-{{pengguna.npm}}" name="bannedhingga" type="date" value="{{pengguna.banned_hingga}}" class="datepicker" required/>
  			</div>
  		</div>
  	</div>
  	<div class="modal-footer">
  		<button type="submit" class=" modal-action waves-effect waves-green btn">Simpan</button>
  	</div>
  </form>
  <!-- Modal Structure -->
  <div id="modal-hapus-pengguna-{{pengguna.npm}}" class="modal">
  	<div class="modal-content">
  		<div class="col s2">
  			<i class="medium mdi-action-announcement"></i>
  		</div>
  		<div class="col s9">
  			<p>Hapus pengguna {{ pengguna.npm }}</p>
  		</div>
  	</div>
  	<div class="modal-footer">
  		<a href="#!" class="modal-action modal-close waves-effect waves-green btn">Batal</a>
  		<a href="{{ urlFor('penggunadelete', {'npm' : pengguna.npm }) }}" class="modal-action waves-effect waves-green btn geser-kanan-dikit">Hapus</a>
  	</div>
  </div>
{% endfor %}

{% endblock %}